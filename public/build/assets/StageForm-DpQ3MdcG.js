import{D as b}from"./DefaultButton-BJYOmEJa.js";import{f as p}from"./fieldValidation-2uvnKSNg.js";import{p as r,g as h,o as n,b as m,t as S,c as _,h as v,w as o,a as l,F as D,l as P,f as g,s as M,E as f}from"./app-CHvJyrNR.js";import{a as N,b as C}from"./options-BX_fygnT.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Y={class:"space-y-6 p-5"},B={class:"border-b pb-4 text-lg font-bold text-gray-900"},E={class:"px-2"},F={class:"flex justify-end space-x-3"},T={props:{propertyModal:{type:Object,default:null}},data(){return{process:!1,loaded:!0,isValid:!1,editorData:null,form:{admission_student_stage:this.propertyModal.data.admission_student_stage.uuid,scheduled_at:null,description:null,status:null},field:{scheduled_at:{label:"Jadwal",rules:[p.isRequired("Jadwal")],error:null,disabled:!0},description:{label:"Keterangan",rules:[p.isRequired("Keterangan")],error:null},status:{label:"Pilih Status",rules:[p.isRequired("Pilih Status")],error:null,disabled:!1,options:[]}}}},created(){if(this.propertyModal.data.admission_student_stage){let t=this.propertyModal.data.admission_student_stage;this.form.admission_student_stage=t.uuid,this.form.scheduled_at=t.scheduled_at,this.form.description=t.description,this.form.status=t.status,t.type=="PRE"&&(this.field.status.options=N),t.type=="POST"&&(this.field.status.options=C)}},methods:{submit(){this.$refs.stageForm.validate(t=>{if(t){this.process=!0;let e=JSON.parse(JSON.stringify(this.form));M.post(route("school.activity.admissionStudent.updateStage"),e,{headers:{"Content-Type":"application/json"}}).then(s=>{s.data.status==="success"?(f({title:"Berhasil",message:s.data.message,type:"success"}),setTimeout(()=>{this.close(),this.$inertia.reload()},2e3)):s.data.status==="error"&&f({title:"Error",message:s.data.message,type:"error"})}).catch(s=>{var u,d;if(f({title:"Error",message:"Terjadi kesalahan.",type:"error"}),(d=(u=s.response)==null?void 0:u.data)!=null&&d.errors)for(let i in s.response.data.errors)this.field[i].error=s.response.data.errors[i],this.$refs.stageForm.validateField(i)}).finally(()=>{this.process=!1})}})},close(){this.$emit("close")}}},H=Object.assign(T,{__name:"StageForm",setup(t){return(e,s)=>{var c;const u=r("el-date-picker"),d=r("el-form-item"),i=r("el-option"),y=r("el-select"),k=r("el-input"),V=r("el-form");return n(),h("div",Y,[m("h2",B,S((c=t.propertyModal)==null?void 0:c.title),1),m("div",E,[e.loaded?(n(),_(V,{key:0,ref:"stageForm","label-position":"top",model:e.form,disabled:e.process},{default:o(()=>[l(d,{class:"font-bold",label:e.field.scheduled_at.label,rules:e.field.scheduled_at.rules,error:e.field.scheduled_at.error,prop:"scheduled_at"},{default:o(()=>[l(u,{modelValue:e.form.scheduled_at,"onUpdate:modelValue":s[0]||(s[0]=a=>e.form.scheduled_at=a),type:"datetime",disabled:e.field.scheduled_at.disabled,format:"DD-MM-YYYY HH:mm","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue","disabled"])]),_:1},8,["label","rules","error"]),l(d,{class:"font-bold",label:e.field.status.label,rules:e.field.status.rules,error:e.field.status.error,prop:"status"},{default:o(()=>[l(y,{modelValue:e.form.status,"onUpdate:modelValue":s[1]||(s[1]=a=>e.form.status=a),placeholder:`Pilih ${e.field.status.label}`,"loading-text":"...","no-match-text":"Data tidak ditemukan","no-data-text":"Tidak ada data",disabled:e.field.status.disabled,autocomplete:"off"},{default:o(()=>[(n(!0),h(D,null,P(e.field.status.options,a=>(n(),_(i,{disabled:a.value=="PENDING",key:a.value,label:a.label,value:a.value},null,8,["disabled","label","value"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["label","rules","error"]),l(d,{class:"font-bold",label:e.field.description.label,rules:e.field.description.rules,error:e.field.description.error,prop:"description"},{default:o(()=>[l(k,{type:"textarea",modelValue:e.form.description,"onUpdate:modelValue":s[2]||(s[2]=a=>e.form.description=a),rows:"8",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label","rules","error"])]),_:1},8,["model","disabled"])):v("",!0)]),m("div",F,[l(b,{type:"light",onClick:e.close,disabled:e.process},{default:o(()=>s[3]||(s[3]=[g(" Batal ")])),_:1},8,["onClick","disabled"]),l(b,{type:"default",onClick:e.submit,disabled:e.process},{default:o(()=>s[4]||(s[4]=[g(" Perbarui Status ")])),_:1},8,["onClick","disabled"])])])}}});export{H as default};
