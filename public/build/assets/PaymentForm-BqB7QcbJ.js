import{D as d}from"./DefaultButton-BJYOmEJa.js";import{m as p}from"./midtrans-CL9d1pBS.js";import{g as n,o as i,b as e,t as r,h as g,f as l,a as m,w as y,s as f,E as o}from"./app-CHvJyrNR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const b={class:"space-y-6 p-5"},u={class:"border-b pb-4 text-lg font-bold text-gray-900"},h={class:"space-y-4"},k={class:"space-y-4 border-gray-200 dark:border-gray-700"},x={class:"space-y-4 rounded-lg border border-gray-100 bg-gray-50 p-6 text-sm dark:border-gray-700 dark:bg-gray-800 md:mb-8"},_={class:"items-center justify-between gap-4 sm:flex"},w={class:"font-medium text-gray-900 dark:text-white sm:text-end"},P={class:"items-center justify-between gap-4 sm:flex"},v={class:"font-medium text-gray-900 dark:text-white sm:text-end"},T={class:"items-center justify-between gap-4 sm:flex"},j={class:"font-medium text-gray-900 dark:text-white sm:text-end"},C={class:"space-y-4"},D={class:"space-y-4 rounded-lg border border-gray-100 bg-gray-50 p-6 text-sm dark:border-gray-700 dark:bg-gray-800"},B={class:"flex items-center justify-between gap-4"},M={class:"font-medium text-gray-900 dark:text-white"},N={class:"flex items-center justify-between gap-4 border-t border-gray-200 pt-2 text-base dark:border-gray-700"},E={class:"font-bold text-gray-900 dark:text-white"},I={key:0,class:"mb-4 flex items-center rounded-lg bg-green-50 p-4 text-sm text-green-800 dark:bg-gray-800 dark:text-green-400",role:"alert"},S={key:0,class:"flex justify-end space-x-3"},V={key:1,class:"flex justify-end space-x-3"},A={props:{propertyModal:{type:Object,default:null}},data(){var a,s;return{process:!1,loaded:!0,isValid:!1,transaction:(s=(a=this.propertyModal)==null?void 0:a.data)==null?void 0:s.transaction}},watch:{},methods:{submit(){this.process=!0;let a=this.transaction.payments[0];if(a.type=="ONLINE"){let s=a.options.gateway_token;try{window.snap.pay(s,{onSuccess:t=>{console.log(t),this.processPayment(a,t),o({title:"Pembayaran Berhasil",message:"Terima kasih! Pembayaran Anda telah berhasil diproses.",type:"success"}),this.process=!1},onPending:t=>{console.log(t),this.processPayment(a,t),o({title:"Menunggu Pembayaran",message:"Pembayaran Anda tertunda. Silakan selesaikan transaksi segera.",type:"warning"}),this.process=!1},onError:t=>{console.log(t),this.processPayment(a,t),o({title:"Pembayaran Gagal",message:"Terjadi kesalahan dalam proses pembayaran. Silakan coba lagi.",type:"error"}),this.process=!1},onClose:t=>{console.log(t),o({title:"Transaksi Ditutup",message:"Anda telah menutup pembayaran.",type:"info"}),this.process=!1}})}catch(t){this.process=!0,console.error(t)}}},processPayment(a,s){this.process=!0,f.post(route("guardian.transactionPayment.processPayment"),{transaction_payment:a.uuid,gateway_response:s},{headers:{"Content-Type":"application/json"}}).then(t=>{console.log(t.data.status),t.data.status&&setTimeout(()=>{this.close(),this.$inertia.reload()},2e3)}).catch(t=>{o({title:"Error",message:t,type:"error"})}).finally(()=>{this.process=!1})},close(){this.$emit("close")}}},$=Object.assign(A,{__name:"PaymentForm",setup(a){return p.init(),(s,t)=>{var c;return i(),n("div",b,[e("h2",u,r((c=a.propertyModal)==null?void 0:c.title),1),e("div",h,[e("div",k,[t[3]||(t[3]=e("h4",{class:"text-base font-semibold text-gray-900 dark:text-white"}," Informasi ",-1)),e("div",x,[e("dl",_,[t[0]||(t[0]=e("dt",{class:"mb-1 font-normal text-gray-500 dark:text-gray-400 sm:mb-0"}," Order ID ",-1)),e("dd",w,r(s.transaction.reference_number),1)]),e("dl",P,[t[1]||(t[1]=e("dt",{class:"mb-1 font-normal text-gray-500 dark:text-gray-400 sm:mb-0"}," Jenis Transaksi ",-1)),e("dd",v,r(s.transaction.sub_type_label),1)]),e("dl",T,[t[2]||(t[2]=e("dt",{class:"mb-1 font-normal text-gray-500 dark:text-gray-400 sm:mb-0"}," Tempo Pembayaran ",-1)),e("dd",j,r(s.transaction.due_date_label),1)])])]),e("div",C,[t[7]||(t[7]=e("h4",{class:"text-base font-semibold text-gray-900 dark:text-white"}," Tagihan ",-1)),e("div",D,[e("dl",B,[t[4]||(t[4]=e("dt",{class:"font-normal text-gray-500 dark:text-gray-400"}," Harga ",-1)),e("dd",M," IDR "+r(s.transaction.total_amount),1)]),t[6]||(t[6]=e("dl",{class:"flex items-center justify-between gap-4"},[e("dt",{class:"font-normal text-gray-500 dark:text-gray-400"}," Diskon "),e("dd",{class:"font-medium text-green-500 dark:text-white"}," - ")],-1)),e("dl",N,[t[5]||(t[5]=e("dt",{class:"font-bold text-gray-900 dark:text-white"}," Total ",-1)),e("dd",E," IDR "+r(s.transaction.bill_amount),1)])])]),s.transaction.is_paid_off?(i(),n("div",I,t[8]||(t[8]=[e("svg",{class:"me-3 inline h-4 w-4 shrink-0","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 20 20"},[e("path",{d:"M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"})],-1),e("span",{class:"sr-only"},"Info",-1),e("div",null,[e("span",{class:"t font-medium"},"Tagihan lunas!"),l(" Pembayaran telah diterima. Terima kasih telah menyelesaikan pembayaran. ")],-1)]))):g("",!0)]),s.transaction.is_paid_off?(i(),n("div",V,[m(d,{class:"w-full",type:"default",onClick:s.close},{default:y(()=>t[11]||(t[11]=[l(" Tutup ")])),_:1},8,["onClick"])])):(i(),n("div",S,[m(d,{class:"w-full",type:"light",onClick:s.close,disabled:s.process},{default:y(()=>t[9]||(t[9]=[l(" Batal ")])),_:1},8,["onClick","disabled"]),m(d,{class:"w-full",type:"default",onClick:s.submit,disabled:s.process},{default:y(()=>t[10]||(t[10]=[l(" Selesaikan Pembayaran ")])),_:1},8,["onClick","disabled"])]))])}}});export{$ as default};
